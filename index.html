<!DOCTYPE html><html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Tactical Map PRO v2</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<style>
/* --- Layout Base --- */
* { margin:0; padding:0; box-sizing:border-box; }
html, body { height:100%; font-family:system-ui; overflow:hidden; }
#map { width:100%; height:100%; z-index:1; }
.header { position:absolute; top:0; left:0; right:0; height:50px; background:rgba(31,41,55,0.95); color:white; z-index:1001; display:flex; justify-content:space-between; align-items:center; padding:0 10px; border-bottom:1px solid #374151; backdrop-filter:blur(10px); }
.header-left { display:flex; align-items:center; gap:8px; }
.header-title { font-weight:bold; font-size:14px; }
.header-subtitle { font-size:10px; color:#9ca3af; }
.btn { padding:6px 10px; background:#374151; border:none; border-radius:4px; color:white; cursor:pointer; font-size:18px; }
.btn:hover { background:#4b5563; }
.btn:active { background:#6b7280; }
/* --- Info Panel --- */
.info-panel { position:absolute; top:60px; left:10px; right:10px; background:rgba(31,41,55,0.98); color:white; padding:12px; border-radius:8px; z-index:1000; border:1px solid #374151; max-width:400px; backdrop-filter:blur(10px); }
.info-value { font-family:monospace; font-size:11px; color:#10b981; background:#111827; padding:8px; border-radius:4px; border:1px solid #374151; margin-bottom:8px; word-break:break-all; }
/* --- Layer Selector --- */
.layer-selector { position:absolute; top:60px; right:10px; background:rgba(31,41,55,0.95); color:white; padding:8px; border-radius:8px; z-index:1000; backdrop-filter:blur(10px); display:none; }
.layer-selector.open { display:block; }
.layer-btn { padding:8px 12px; margin:4px 0; width:100%; background:#374151; border:none; color:white; border-radius:4px; cursor:pointer; font-size:12px; }
.layer-btn:hover { background:#4b5563; }
.layer-btn.active { background:#10b981; }
/* --- Mirino --- */
.crosshair { position:absolute; width:32px; height:32px; margin-left:-16px; margin-top:-16px; pointer-events:none; z-index:1500; }
.crosshair:before, .crosshair:after { content:''; position:absolute; background:red; }
.crosshair:before { left:50%; top:0; width:2px; height:100%; transform:translateX(-50%); }
.crosshair:after { top:50%; left:0; width:100%; height:2px; transform:translateY(-50%); }
</style>
</head>
<body>
<div id="map"></div>
<div class="header">
  <div class="header-left">
    <span style="font-size:20px;">üéØ</span>
    <div>
      <div class="header-title">TACTICAL MAP PRO</div>
      <div class="header-subtitle">v2</div>
    </div>
  </div>
  <div style="display:flex;gap:8px;">
    <button class="btn" onclick="toggleLayers()">üó∫Ô∏è</button>
  </div>
</div>
<div class="info-panel" id="infoPanel">
  <div class="info-value" id="coordsDisplay">Attendi GPS...</div>
</div>
<div class="layer-selector" id="layerSelector">
  <button class="layer-btn active" onclick="changeMap('osm')">üó∫Ô∏è Street</button>
  <button class="layer-btn" onclick="changeMap('satellite')">üõ∞Ô∏è Satellite</button>
  <button class="layer-btn" onclick="changeMap('topo')">‚õ∞Ô∏è Topo</button>
  <button class="layer-btn" onclick="changeMap('dark')">üåô Dark</button>
</div>
<div id="crosshair" class="crosshair" style="display:none;"></div>
<script>
let map, userMarker=null, userLocation=null;
let crosshair = document.getElementById('crosshair');
let currentLayer;
let layers = {};// --- Map Init --- map = L.map('map',{zoomControl:true}).setView([41.9028,12.4964],6); layers['osm'] = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{maxZoom:19}).addTo(map); layers['satellite'] = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',{maxZoom:19}); layers['topo'] = L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png',{maxZoom:17}); layers['dark'] = L.tileLayer('https://stamen-tiles.a.ssl.fastly.net/toner/{z}/{x}/{y}.png',{maxZoom:20}); currentLayer = 'osm';

function changeMap(layer){ if(currentLayer!==layer){ map.removeLayer(layers[currentLayer]); map.addLayer(layers[layer]); currentLayer = layer; document.querySelectorAll('.layer-btn').forEach(b=>b.classList.remove('active')); event.target.classList.add('active'); document.getElementById('layerSelector').classList.remove('open'); } }

function toggleLayers(){ document.getElementById('layerSelector').classList.toggle('open'); }

// --- GPS --- if(navigator.geolocation){ navigator.geolocation.watchPosition(pos=>{ userLocation = pos.coords; let latlng = [userLocation.latitude,userLocation.longitude]; if(!userMarker){ userMarker = L.marker(latlng).addTo(map); }else{ userMarker.setLatLng(latlng); } document.getElementById('coordsDisplay').textContent = Lat: ${userLocation.latitude.toFixed(6)} | Lng: ${userLocation.longitude.toFixed(6)}; },err=>{console.error('GPS error',err);},{enableHighAccuracy:true,maximumAge:1000,timeout:10000}); }

// --- Crosshair / Mirino --- map.on('click', e=>{ crosshair.style.display='block'; let point = map.latLngToContainerPoint(e.latlng); crosshair.style.left = point.x+'px'; crosshair.style.top = point.y+'px'; alert(Mirino a Lat:${e.latlng.lat.toFixed(6)} Lng:${e.latlng.lng.toFixed(6)}); });

// --- Nascondi layer menu su zoom / move --- map.on('zoomstart move',()=>{ document.getElementById('layerSelector').classList.remove('open'); }); </script>

</body>
</html>
